<div class="container mt-4">
    <h2>Panel de Administración de Vehículos</h2>

    <button class="btn btn-primary mb-3" (click)="toggleFormulario()">
        {{ mostrarFormulario ? 'Cancelar' : 'Agregar Vehículo' }}
    </button>

    <!-- Formulario -->
    <div *ngIf="mostrarFormulario" class="card mb-4">
        <div class="card-body">
            <h3>{{ nuevoVehiculo.idVehiculo ? 'Editar Vehículo' : 'Nuevo Vehículo' }}</h3>
            <form (ngSubmit)="guardarVehiculo()">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label>Placa</label> 
                        <input type="text" class="form-control" [(ngModel)]="nuevoVehiculo.placa" name="placa" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Marca</label>
                        <input type="text" class="form-control" [(ngModel)]="nuevoVehiculo.marca" name="marca" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Modelo</label>
                        <input type="text" class="form-control" [(ngModel)]="nuevoVehiculo.modelo" name="modelo"
                            required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Año</label>
                        <input type="number" class="form-control" [(ngModel)]="nuevoVehiculo.anio" name="anio" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Color</label>
                        <input type="text" class="form-control" [(ngModel)]="nuevoVehiculo.color" name="color" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Precio Diario</label>
                        <input type="number" class="form-control" [(ngModel)]="nuevoVehiculo.precioDiario"
                            name="precioDiario" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Kilometraje</label>
                        <input type="number" class="form-control" [(ngModel)]="nuevoVehiculo.kilometrajeActual"
                            name="kilometrajeActual" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Tipo Vehículo</label>
                        <select class="form-select" [(ngModel)]="nuevoVehiculo.tipoVehiculo" name="tipoVehiculo">
                            <option value="AUTO">AUTO</option>
                            <option value="CAMIONETA">CAMIONETA</option>
                            <option value="DEPORTIVO">DEPORTIVO</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Estado</label>
                        <select class="form-select" [(ngModel)]="nuevoVehiculo.estado" name="estado">
                            <option value="DISPONIBLE">DISPONIBLE</option>
                            <option value="ALQUILADO">ALQUILADO</option>
                            <option value="MANTENIMIENTO">MANTENIMIENTO</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Asientos</label>
                        <input type="number" class="form-control" [(ngModel)]="nuevoVehiculo.asientos" name="asientos"
                            required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Transmisión</label>
                        <select class="form-select" [(ngModel)]="nuevoVehiculo.transmision" name="transmision">
                            <option value="MECANICO">MECANICO</option>
                            <option value="AUTOMATICO">AUTOMATICO</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label>Combustible</label>
                        <select class="form-select" [(ngModel)]="nuevoVehiculo.combustible" name="combustible">
                            <option value="GASOLINA">GASOLINA</option>
                            <option value="PETROLEO">PETROLEO</option>
                            <option value="ELECTRICO">ELECTRICO</option>
                            <option value="HIBRIDO">HIBRIDO</option>
                            <option value="GLP">GLP</option>
                            <option value="GNV">GNV</option>
                        </select>
                    </div>
                    <div class="col-md-12 mb-3">
                        <label>URL Imagen</label>
                        <input type="text" class="form-control" [(ngModel)]="nuevoVehiculo.imagenUrl" name="imagenUrl">
                    </div>
                    <div class="col-md-12 mb-3">
                        <label>Descripción</label>
                        <textarea class="form-control" [(ngModel)]="nuevoVehiculo.descripcion" name="descripcion"
                            rows="3"></textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-success">{{ nuevoVehiculo.idVehiculo ? 'Actualizar' : 'Guardar'
                    }}</button>
            </form>
        </div>
    </div>

    <!-- Lista de Vehículos -->
    <div class="table-responsive">
        <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
                <tr>
                    <th>Imagen</th>
                    <th>Placa</th>
                    <th>Marca</th>
                    <th>Modelo</th>
                    <th>Año</th>
                    <th>Precio</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let v of vehiculos">
                    <td>
                        <img [src]="v.imagenUrl || 'https://via.placeholder.com/100'" alt="Auto"
                            style="width: 80px; height: auto; object-fit: cover;">
                    </td>
                    <td>{{ v.placa }}</td>
                    <td>{{ v.marca }}</td>
                    <td>{{ v.modelo }}</td>
                    <td>{{ v.anio }}</td>
                    <td>{{ v.precioDiario | currency:'S/ ' }}</td>
                    <td>
                        <span class="badge"
                            [ngClass]="{'bg-success': v.estado === 'DISPONIBLE', 'bg-warning': v.estado !== 'DISPONIBLE'}">
                            {{ v.estado }}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-warning btn-sm me-2" (click)="editarVehiculo(v)">Editar</button>
                        <button class="btn btn-danger btn-sm" (click)="eliminarVehiculo(v.idVehiculo)">Eliminar</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>